---
title: "Harmonize location information for RS pull"
author: "ROSSyndicate"
date: "2024-01-18"
output: html_document
---

# Purpose

This script collates the locations from the upstream GLORIA dataset and the
Maciel, et al matchups to replicate the analysis, but with corrections to the 
surface reflectance data to better align sensor changes between missions.

## Collate locations

To effectively collate the locations, we're going to use the upstream GLORIA 
metadata, retaining only the GLORIA_ID and latitude/longitude columns and grab
the unique locations from the Maciel dataset, flagging GLORIA overlap and adding
any additional locations to the resulting location collation. CRS is not 
specified for either dataset, so we assume WGS84

```{r load-data}
library(tidyverse)

gloria_locs <- read_csv("data/GLORIA_meta_and_lab.csv")
maciel_matchup <- read_csv("data/Matchups.csv")

gloria_locs <- gloria_locs %>% 
  select(GLORIA_ID, Latitude, Longitude) %>% 
  distinct()

maciel_locs <- maciel_matchup %>% 
  select(Maciel_ID = ID, 
         Latitude = lat, 
         Longitude = long) %>% 
  distinct() %>% 
  mutate(GLORIA_ID = if_else(grepl("\\bGID_", Maciel_ID),
                             Maciel_ID,
                             NA_character_),
         maciel = 1)

collated_locs = full_join(gloria_locs, maciel_locs) %>% 
  mutate(ID = if_else(is.na(GLORIA_ID),
                           Maciel_ID,
                           GLORIA_ID)) %>% 
  select(ID, Latitude, Longitude) %>% 
  rowid_to_column() %>% 
  filter(!is.na(Latitude|Longitude))
```

## Export collated file

```{r}
write_csv(collated_locs, "data/collated_locations_for_pull.csv")
```



